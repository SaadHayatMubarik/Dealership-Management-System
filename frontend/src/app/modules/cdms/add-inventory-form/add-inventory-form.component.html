<p-toast></p-toast>
<div class="comp-content">
  <div class="toolbar-header mb-3">
    <div class="comp-title">
      <h3>Inventory</h3>
    </div>
    <div class="comp-btns">
      <app-button label="Add" styleClass="p-button-sm p-button-rounded" (onclick)="openModal()"></app-button>
    </div>
  </div>
  <div class="middle-content w-o-tabs mt-3">
    <div class="filter-row flex justify-content-between pt-3">
    </div>

    <p-tabView (onChange)="onTabChange($event)" [(activeIndex)]="selectedTabIndex" >
      <p-tabPanel header="Available">
        <app-datatable [data]="data" [cols]="columns" [globalFilterFields]="['vehicleMake','vehicleModel','vehicleVariant','vehicleChasisNo']" [actions]="actions"></app-datatable>
      </p-tabPanel>
      <p-tabPanel header="Sold">
        <app-datatable [data]="data" [cols]="columns" [globalFilterFields]="['vehicleMake','vehicleModel','vehicleVariant','vehicleChasisNo']" [actions]="actions"></app-datatable>
      </p-tabPanel>
      <p-tabPanel header="On Order">
        <app-datatable [data]="data" [cols]="columns" [globalFilterFields]="['vehicleMake','vehicleModel','vehicleVariant','vehicleChasisNo']" [actions]="actions"></app-datatable>
      </p-tabPanel>

    </p-tabView>
  
  
  
  
  </div>
  <p-sidebar [(visible)]="modal" position="right" [style]="{ width:'80rem'}">

    <p-tabView [(activeIndex)]="activeTabIndex">
      <p-tabPanel header="Vehicle Details">
        <form (ngSubmit)="onNext()" #Inventory="ngForm">
          <div class="sidebar-main">
            <div class="sidebar-header">
              <div class="sh-title">
                <h3 style="text-align: center;">
                  Add Inventory
                </h3>
                <h5 style="text-align: center;">Vehicle Details</h5>
                <br>
              </div>
              <div class="sh-toolbar">
              </div>
            </div>
            <div class="sidebar-content">
              <div class="card-grey padding">
                <div class="row-form grid" >
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <p-dropdown class="p-inputtext-lg" 
                        placeholder="Select a Vehicle Type" 
                        [options]="vehicleTypes" 
                        optionLabel="type_name"
                         (onChange)="onVehicleTypeChange($event)"
                         name="vehicleType"
                         [(ngModel)]="vehicleInventory.vehicleType"
                         [required]="true"
                         ></p-dropdown>
                        <label for="float-label">Vehicle Type*</label>
                    </span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <input 
                        class="p-inputtext-lg"
                         pInputText 
                         name="make"
                         required
                         [(ngModel)]="vehicleInventory.vehicleMake"
                         />
                        <label htmlFor="username">Make*</label>
                    </span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <input class="p-inputtext-lg" 
                        pInputText
                        name="model"
                        required
                        [(ngModel)]="vehicleInventory.vehicleModel"
                        />
                        <label htmlFor="username">Model*</label>
                    </span>
                    </div>
                  </div>
                </div>
                <br>
                <div class="row-form grid">
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <input class="p-inputtext-lg"
                        required
                         pInputText
                         name="variant"
                         [(ngModel)]="vehicleInventory.vehicleVariant"
                         />
                        <label htmlFor="username">Variant*</label>
                    </span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <input class="p-inputtext-lg" 
                        pInputText
                        name="Chasis No"
                        [(ngModel)]="vehicleInventory.vehicleChasisNo"
                        />
                        <label htmlFor="username">Chasis No</label>
                      </span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <input class="p-inputtext-lg" 
                        pInputText
                        name="engineNo"
                        [(ngModel)]="vehicleInventory.engineNo"
                        />
                        <label for="float-label">Engine No</label>
                    </span>
                    </div>
                  </div>
                </div>
                <br>
                <div class="row-form grid">
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <p-inputNumber class="p-inputtext-lg" 
                         mode="currency" 
                         currency="PKR" 
                         locale="en-US"
                         name="costPrice"
                         [(ngModel)]="vehicleInventory.costPrice"
                         > </p-inputNumber>
                        <label for="float-label">Cost Price*</label>
                    </span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <p-inputNumber class="p-inputtext-lg"  
                        mode="currency"
                         currency="PKR" 
                         locale="en-US"
                         name="demand"
                         [(ngModel)]="vehicleInventory.demand"
                         > </p-inputNumber>
                        <label for="float-label">Demand*</label>
                    </span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <p-calendar [readonlyInput]="true" 
                        class="p-inputtext-lg"
                        name="date of purchase"
                        [(ngModel)]="vehicleInventory.dateOfPurchase"
                        ></p-calendar>
                        <label>Date Of Purcahse*</label>
                    </span>
                    </div>
                  </div>
                </div>
                <br>
                <div class="row-form grid">
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <p-calendar [readonlyInput]="true" 
                        class="p-inputtext-lg"
                        name="date of sale"
                        [(ngModel)]="vehicleInventory.dateOfSale"
                        ></p-calendar>
                        <label>Date Of Sale</label>
                    </span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <input class="p-inputtext-lg" 
                        pInputText
                        required
                        name="color"
                        [(ngModel)]="vehicleInventory.bodyColor"
                        />
                        <label htmlFor="username">Body Color*</label>
                    </span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                    <span class="p-float-label">
                      <p-dropdown
                       [options]="status" 
                       class="p-inputtext-lg" 
                       placeholder="Select a Vehicle Type"
                       name="status"
                        [(ngModel)]="vehicleInventory.status"
                        [required]="true"
                       ></p-dropdown>
                      <label for="float-label">Status*</label>
                    </span>
                    </div>
                  </div>
                </div>
                <br>
                <div class="row-form grid">
                  <div class="col-4">
                    <div class="p-field">
                    <span class="p-float-label">
                      <input class="p-inputtext-lg" 
                      pInputText  
                      name="RegNo"
                      [(ngModel)]="vehicleInventory.regNo"
                      />
                      <label for="float-label">Registration Number</label>
                  </span>
                  </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <p-inputNumber class="p-inputtext-lg" 
                         name="milage"
                         [(ngModel)]="vehicleInventory.mileage"
                         > </p-inputNumber>
                        <label for="float-label">Mileage*</label>
                    </span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="p-field">
                      <span class="p-float-label">
                        <input 
                        class="p-inputtext-lg"
                         pInputText 
                         name="modelYear"
                         [(ngModel)]="vehicleInventory.modelYear"
                         />
                        <label htmlFor="Model Year">Model Year*</label>
                    </span>
                    </div>
                  </div>
                </div>
                  <br>
                  <div class="row-form grid">
                  <div class="col-8">
                    <div class="p-field">
                    <span class="p-float-label">
                      <textarea id="float-input" 
                      rows="5" cols="80" 
                      pInputTextarea
                      name="comments"
                      [(ngModel)]="vehicleInventory.comments"
                      ></textarea>
                      <label for="float-label">Other Details</label>
                  </span>
                  </div>
                </div>
                <!-- </div> -->
                <!-- <br> -->
                
                  <div class="col-3">
                    <div class="p-field">
                      <label>Grade*</label>
                    <input type="number" 
                    pInputText 
                    [(ngModel)]="sliderValue"
                     class="w-full" 
                     (input)="onInputChange($event)" 
                     (keydown)="onKeyDown($event)"
                      [min]="0" 
                      [max]="5"
                      name="grade"
                      required
                      [(ngModel)]="vehicleInventory.grade"
                      />
                      <!-- <p-slider [(ngModel)]="sliderValue" [min]="0" [max]="5" [step]="0.5" class="w-full"></p-slider> -->
                    </div>
                  </div> 
                </div>
              <br>
             <!-- adding dynamic form here-->
                  <div *ngIf="vehicleInventory.stockAttributeValue.length > 0">
                     <h5 style="text-align: center;">Additional Details</h5> <br>
                    <div class="row-form grid">
                      <div class="col-4" *ngFor="let attribute of vehicleInventory.stockAttributeValue; let i = index">
                        <div *ngIf="attribute.vehicleTypeAttribute.input_type === 'text'">
                          <div class="p-field">
                            <span class="p-float-label">
                              <input class="p-inputtext-lg"
                               pInputText
                               [(ngModel)]="attribute.value" 
                               name="Dynamic Form"
                               />
                              <label for="float-label">{{ attribute.vehicleTypeAttribute.attribute_name }}</label>
                            </span>
                          </div>
                        </div>
                        <div *ngIf="attribute.vehicleTypeAttribute.input_type === 'number'">
                          <div class="p-field">
                            <span class="p-float-label">
                              <input class="p-inputtext-lg" 
                              pInputText 
                              [(ngModel)]="attribute.value" 
                              name="Dynamic Form2" 
                              />
                              <label for="float-label">{{attribute.vehicleTypeAttribute.attribute_name }}</label>
                            </span>
                          </div>
                        </div>
                        <div *ngIf="attribute.vehicleTypeAttribute.input_type === 'date'">
                          <div class="p-field">
                            <span class="p-float-label">
                              <p-calendar [readonlyInput]="true" 
                              class="p-inputtext-lg"
                              name="Dynamic Form3"
                              [(ngModel)]="attribute.value"
                              ></p-calendar>
                              <label for="float-label">{{attribute.vehicleTypeAttribute.attribute_name }}</label>
                            </span>
                          </div>
                        </div>
                        <div *ngIf="attribute.vehicleTypeAttribute.input_type === 'dropdown'">
                          <span class="p-float-label">                
                            <p-dropdown class="p-inputtext-lg" 
                            placeholder="Select {{ attribute.vehicleTypeAttribute.attribute_name}}" 
                            [options]="getOptions(attribute)" 
                            [(ngModel)]="attribute.value" 
                            name="Dynamic Form3"  
                            ></p-dropdown>
                            <label for="float-label">{{ attribute.vehicleTypeAttribute.attribute_name}}</label>
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
              </div>
              
              
              <!-- <div class="container">
                <h2>Upload Photos</h2>
                  <span>Choose Images To Upload:</span>
                  <div class="flex justify-content-space-between">
                  <p-fileUpload mode="basic" chooseLabel="Choose" name="demo[]" url="https://www.primefaces.org/cdn/api/upload.php" accept="image/*"></p-fileUpload>
                  
                  <p-fileUpload mode="basic" chooseLabel="Upload" name="demo[]" url="https://www.primefaces.org/cdn/api/upload.php" accept="image/*"></p-fileUpload>
                </div>
                  <div class="image-preview-1">
      
                  </div>            
              </div> -->
             
              <br>
          </div>
            <div class="sidebar-footer flex justify-content-end">
              <app-button
              type="submit"
               label="Next" 
               styleClass="p-button-sm p-button-rounded" 
               ></app-button>
            </div>
          </div>
        </form>
      </p-tabPanel>
      
      <p-tabPanel header="Seller Details" [disabled]="!showSecondTab">
        
      <form (ngSubmit)="postInventory()" #Seller="ngForm"> 
        <div class="sidebar-main">
          <div class="sidebar-header">
            <div class="sh-title">
              <h3 style="text-align: center;">
                Add Inventory
              </h3>
              <h5 style="text-align: center;"> Seller Details</h5>
              <br>
            </div>
            <div class="sh-toolbar">
              </div>
            </div>
          </div>
          <div class="sidebar-content">
            <div class="card-grey padding">
              <div class="row-form grid" >
                <div class="col-4">
                  <div class="p-field">
                  <span class="p-float-label">
                    <p-dropdown
                     [options]="sellerCategory" 
                     class="p-inputtext-lg" 
                     placeholder="Select a Vehicle Type"
                     name="seller_category"
                     [(ngModel)]="selectedSellerCategory"
                     ></p-dropdown>
                    <label for="float-label">Seller Category</label>
                  </span>
                  </div>
                </div>
                <div class="col-4">
                  <div class="p-field">
                    <span class="p-float-label">
                      <input 
                      class="p-inputtext-lg"
                       pInputText 
                       name="name"
                       required
                       />
                       <label htmlFor="customerName">
                        {{ selectedSellerCategory === 'AGENT' ? 'Agent' : selectedSellerCategory === 'CUSTOMER' ? 'Customer' : selectedSellerCategory === 'DEALERSHIP' ? 'Dealership' : '' }} Name
                      </label>
                  </span>
                  </div>
                </div>
                <div class="col-4">
                  <div class="p-field">
                    <span class="p-float-label">
                      <input class="p-inputtext-lg" 
                      pInputText
                      name="contactNumber"
                      required
                      />
                      <label htmlFor="username">Contact Number</label>
                  </span>
                  </div>
                </div>
              </div>
              <br>
              <div class="row-form grid">
                <div class="col-4">
                  <div class="p-field">
                    <span class="p-float-label">
                      <input class="p-inputtext-lg"
                      required
                       pInputText
                       name="email"
                       />
                      <label htmlFor="username">Email</label>
                  </span>
                  </div>
                </div>
                <div class="col-4">
                  <div class="p-field">
                    <span class="p-float-label">
                      <input class="p-inputtext-lg" 
                      pInputText
                      name="Chasis No"
                      [(ngModel)]="vehicleInventory.vehicleChasisNo"
                      />
                      <label htmlFor="username">Province</label>
                    </span>
                  </div>
                </div>
                <div class="col-4">
                  <div class="p-field">
                    <span class="p-float-label">
                      <input class="p-inputtext-lg" 
                      pInputText
                      name="engineNo"
                      [(ngModel)]="vehicleInventory.engineNo"
                      />
                      <label for="float-label">City</label>
                  </span>
                  </div>
                </div>
              </div>
              <br>
              <div class="row-form grid">
                <div class="col-4">
                  <div class="p-field">
                    <span class="p-float-label">
                      <input class="p-inputtext-lg" 
                      pInputText
                      name="engineNo"
                      [(ngModel)]="vehicleInventory.engineNo"
                      />
                      <label for="float-label">Address</label>
                  </span>
                  </div>
                </div>
                <div class="col-4">
                  <div class="p-field" *ngIf="selectedSellerCategory === 'AGENT' || selectedSellerCategory === 'CUSTOMER'">
                    <span class="p-float-label">
                      <input class="p-inputtext-lg" 
                      pInputText
                      name="engineNo"
                      [(ngModel)]="vehicleInventory.engineNo"
                     
                      />
                      <label for="float-label">CNIC</label>
                  </span>
                  </div>
                </div>
              </div>
           
              <br>
              <div class="sidebar-header">
                <div class="sh-title">
                  <h5 style="text-align: center;"> Investor Details</h5>
                  <br>
                
              <br><br>

             <div class= "investor_form" *ngFor="let form of investorForms; let i = index">
              <div class="row-form grid">
                <div class="col-4">
                  <div class="p-field">
                  <span class="p-float-label">
                    <p-dropdown
                     [options]="investor_name" 
                     class="p-inputtext-lg" 
                     placeholder="Select a Vehicle Type"
                     name="investor Name"
                     [(ngModel)]="investorName"
                     ></p-dropdown>
                    <label for="float-label">Investor Name*</label>
                  </span>
                  </div>
                </div>
                <!-- <div class="col-4">
                  <div class="p-field">
                    <div class="flex flex-wrap gap-3">
                      <div class="flex align-items-center">
                          <p-radioButton name="investment" value="Percentage" [(ngModel)]="selectedOption" inputId="investment1"></p-radioButton>
                          <label for="percentage" class="ml-2">Percentage</label>
                      </div>
                      
                      <div class="flex align-items-center">
                          <p-radioButton name="investment" value="Amount" [(ngModel)]="selectedOption" inputId="investment2"></p-radioButton>
                          <label for="amount" class="ml-2">
                            Amount
                          </label>
                      </div>   
                  </div>
                  </div>
                </div> -->

                <div class="col-4">
                  <div class="p-field">
                  <span class="p-float-label">
                    <input class="p-inputtext-lg" 
                    pInputText
                    name="percentage"
                    required
                    />
                    <label for="float-label">Enter percentage %*
                      <!-- {{ selectedOption === 'Amount' ? 'Amount' : selectedOption === 'Percentage' ? 'Percentage' : '' }}% -->
                    </label>  
                                 
                  </span>
                  </div>
                </div>


              <!-- <div class="row-form grid" > -->
                
              <!-- </div> -->
            </div>
              <br>
            </div>
            <div class="row-form grid" >
              <div class="col-4">
              <div class="buttons">
            <p-button icon="pi pi-plus" (click)="addInvestorForm()"></p-button>
            <p-button severity="danger" class="ml-2" icon="pi pi-minus"  (click)="removeInvestorForm()"></p-button>
          </div>
            <!-- <br><br> -->
          </div>
            <div class="col-4">
              <div class="p-field">
              <span class="p-float-label">
                  <input class="p-inputtext-lg" 
                  pInputText
                  name="totalInvestment"
                  required
                  disabled
                  />
                <label for="float-label">Remaining Percentage %</label>
              </span>
              </div>
            </div>
            </div>
          </div>
            </div> 
              </div>
            </div>
            </form>
      </p-tabPanel>
      </p-tabView> 
  </p-sidebar>
</div>








